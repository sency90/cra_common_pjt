<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>CarAssembleApp.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
    <body onload="prettyPrint()">
        <h4></h4>
        <pre class="prettyprint lang-cpp linenums">
ï»¿#include "CarAssembleApp.h"

<span style = "background-color:#dfd">CarAssembleApp::CarAssembleApp():pm(PrintManager::GetInstance()) {
    CommonFunction::GetInstance().PrintSettingForKorean();
}</span>

<span style = "background-color:#dfd">int CarAssembleApp::Run() {
    PageEnum current_page(PageEnum::GetStartPage());</span>

<span style = "background-color:#dfd">    while(1) {
        pm.PrintPage(current_page);</span>

<span style = "background-color:#dfd">        char *input = GetInput();
        RemoveEndNewLine(input);</span>

<span style = "background-color:#dfd">        if(WhenTypedExit(input)) {
            ExitProgram();</span>
        }

        try {
<span style = "background-color:#dfd">            ValidateInput(input, current_page);</span>
        }
<span style = "background-color:#dfd">        catch(std::exception &amp;ex) {
            printf("ERROR :: %s\n", ex.what());
            Delay(800);
            continue;</span>
<span style = "background-color:#fdd">        }</span>

<span style = "background-color:#dfd">        int answer = ChangeInputTypeToInt(input);
        SelectParts(answer, current_page);
        MovePage(answer, current_page);
    }</span>

<span style = "background-color:#fdd">    return 0;
}</span>

<span style = "background-color:#dfd">void CarAssembleApp::Delay(int ms) {</span>
#if _DEBUG
<span style = "background-color:#dfd">    std::this_thread::sleep_for(std::chrono::milliseconds(ms/10));</span>
#else
    std::this_thread::sleep_for(std::chrono::milliseconds(ms));
#endif
<span style = "background-color:#dfd">}</span>

<span style = "background-color:#dfd">bool CarAssembleApp::WhenTypedExit(char *input) {
    return strcmp(input, "exit")==0;
}</span>

<span style = "background-color:#fdd">void CarAssembleApp::ExitProgram() {
    printf("ë°ì´ë°ì´\n");
    exit(0);
}</span>

<span style = "background-color:#fdd">char *CarAssembleApp::GetInput() {</span>
    static char input[128];

<span style = "background-color:#fdd">    printf("INPUT &gt; ");
    fgets(input, sizeof(input), stdin);
    return input;
}</span>

<span style = "background-color:#dfd">void CarAssembleApp::RemoveEndNewLine(char *input) {</span>
    // ìí° ê°íë¬¸ì ì ê±°
<span style = "background-color:#dfd">    char *context = nullptr;
    strtok_s(input, "\r", &amp;context);
    strtok_s(input, "\n", &amp;context);
}</span>

<span style = "background-color:#dfd">void CarAssembleApp::ValidateInput(const char *input, PageEnum page) {</span>
    // ì«ìë¡ ë ëëµì¸ì§ íì¸
    char *checkNumber;
<span style = "background-color:#dfd">    int answer = strtol(input, &amp;checkNumber, 10); // ë¬¸ìì´ì 10ì§ìë¡ ë³í</span>

    // ìë ¥ë°ì ë¬¸ìê° ì«ìê° ìëë¼ë©´
<span style = "background-color:#dfd">    if(*checkNumber != '\0') {
        throw std::invalid_argument("ì«ìë§ ìë ¥ ê°ë¥");</span>
    }

<span style = "background-color:#dfd">    if(page == PageEnum::eCarTypePage &amp;&amp; !(answer &gt;= 1 &amp;&amp; answer &lt;= 3)) {
        throw std::invalid_argument("ì°¨ë íìì 1 ~ 3 ë²ìë§ ì í ê°ë¥");</span>
    }

<span style = "background-color:#dfd">    if(page == PageEnum::eEnginePage &amp;&amp; !(answer &gt;= 0 &amp;&amp; answer &lt;= 4)) {
        throw std::invalid_argument("ìì§ì 1 ~ 4 ë²ìë§ ì í ê°ë¥");</span>
    }

<span style = "background-color:#dfd">    if(page == PageEnum::eBrakePage &amp;&amp; !(answer &gt;= 0 &amp;&amp; answer &lt;= 3)) {
        throw std::invalid_argument("ì ëì¥ì¹ë 1 ~ 3 ë²ìë§ ì í ê°ë¥");</span>
    }

<span style = "background-color:#dfd">    if(page == PageEnum::eSteeringPage &amp;&amp; !(answer &gt;= 0 &amp;&amp; answer &lt;= 2)) {
        throw std::invalid_argument("ì¡°í¥ì¥ì¹ë 1 ~ 2 ë²ìë§ ì í ê°ë¥");</span>
    }

<span style = "background-color:#dfd">    if(page == PageEnum::eRunOrTestPage &amp;&amp; !(answer &gt;= 0 &amp;&amp; answer &lt;= 2)) {
        throw std::invalid_argument("Run ëë Test ì¤ íëë¥¼ ì í íì");</span>
    }
<span style = "background-color:#dfd">}</span>

//ValidateInput()ë¤ìì ChangeInputTypeToInt()ê° ì¤íëì´ì¼ íë¤.
<span style = "background-color:#dfd">int CarAssembleApp::ChangeInputTypeToInt(char *input) noexcept {</span>
    char *checkNumber;
<span style = "background-color:#dfd">    int answer = strtol(input, &amp;checkNumber, 10); // ë¬¸ìì´ì 10ì§ìë¡ ë³í
    return answer;
}</span>

<span style = "background-color:#dfd">bool CarAssembleApp::IsSelectGoBackToStartPage(int answer, PageEnum page) {
    return answer==0 &amp;&amp; page.IsEndPage();
}</span>

<span style = "background-color:#dfd">bool CarAssembleApp::IsSelectGoBackToPrevPage(int answer, PageEnum page) {
    return answer==0 &amp;&amp; false==page.IsStartPage() &amp;&amp; false==page.IsEndPage();
}</span>

<span style = "background-color:#dfd">void CarAssembleApp::MovePage(int answer, PageEnum &amp;page) {</span>
    // ì²ìì¼ë¡ ëìê°ê¸°
<span style = "background-color:#dfd">    if(IsSelectGoBackToStartPage(answer, page)) {</span>
<span style = "background-color:#fdd">        page.MoveToStartPage();
        return;</span>
    }

    // ì´ì ì¼ë¡ ëìê°ê¸°
<span style = "background-color:#dfd">    if(IsSelectGoBackToPrevPage(answer, page)) {</span>
<span style = "background-color:#fdd">        page.MoveToPrevPage();
        return;</span>
    }

<span style = "background-color:#dfd">    if(false == page.IsEndPage()) {
        page.MoveToNextPage();</span>
    }
<span style = "background-color:#dfd">}</span>

<span style = "background-color:#dfd">void CarAssembleApp::SelectParts(int answer, PageEnum page) {
    switch(page.Get()) {</span>
    case PageEnum::eCarTypePage: {
<span style = "background-color:#dfd">        SelectCarType(answer);
        Delay(800);
        break;</span>
    }
    case PageEnum::eEnginePage: {
<span style = "background-color:#dfd">        SelectEngineType(answer);
        Delay(800);
        break;</span>
    }
    case PageEnum::eBrakePage: {
<span style = "background-color:#dfd">        SelectBrakeType(answer);
        Delay(800);
        break;</span>
    }
    case PageEnum::eSteeringPage: {
<span style = "background-color:#dfd">        SelectSteeringType(answer);
        Delay(800);
        break;</span>
    }
    case PageEnum::eRunOrTestPage: {
<span style = "background-color:#dfd">        if(answer == 1) {</span>
<span style = "background-color:#fdd">            RunProducedCar();
        }</span>
<span style = "background-color:#dfd">        else if(answer == 2) {
            printf("Test...\n");
            Delay(1500);
            TestProducedCar();</span>
        }
<span style = "background-color:#dfd">        Delay(2000);</span>
        break;
    }
    } //switch
<span style = "background-color:#dfd">}</span>


<span style = "background-color:#dfd">void CarAssembleApp::SelectCarType(int answer) {
    car_type = CarTypeFactory::Create(answer);
    printf("ì°¨ë íìì¼ë¡ %sì ì ííì¨ìµëë¤.\n", car_type-&gt;GetName().c_str());
}</span>

<span style = "background-color:#dfd">void CarAssembleApp::SelectEngineType(int answer) {
    engine_type = EngineTypeFactory::Create(answer);
    printf("%s ìì§ì ì ííì¨ìµëë¤.\n", engine_type-&gt;GetName().c_str());
}</span>

<span style = "background-color:#dfd">void CarAssembleApp::SelectBrakeType(int answer) {
    brake_type = BrakeTypeFactory::Create(answer);
    printf("%s ì ëì¥ì¹ë¥¼ ì ííì¨ìµëë¤.\n", brake_type-&gt;GetName().c_str());
}</span>

<span style = "background-color:#dfd">void CarAssembleApp::SelectSteeringType(int answer) {
    steering_type = SteeringTypeFactory::Create(answer);
    printf("%s ì¡°í¥ì¥ì¹ë¥¼ ì ííì¨ìµëë¤.\n", steering_type-&gt;GetName().c_str());
}</span>

<span style = "background-color:#dfd">int CarAssembleApp::IsValidCheck() {
    CommonFunction &amp;cf = CommonFunction::GetInstance();
    if(cf.EqualsIgnoreCase(car_type-&gt;GetName(), "Sedan") &amp;&amp; cf.EqualsIgnoreCase(brake_type-&gt;GetName(), "CONTINENTAL")) {
        return false;</span>
<span style = "background-color:#fdd">    }</span>
<span style = "background-color:#dfd">    else if(cf.EqualsIgnoreCase(car_type-&gt;GetName(), "SUV") &amp;&amp; cf.EqualsIgnoreCase(engine_type-&gt;GetName(), "TOYOTA")) {
        return false;</span>
<span style = "background-color:#fdd">    }</span>
<span style = "background-color:#dfd">    else if(cf.EqualsIgnoreCase(car_type-&gt;GetName(), "Truck") &amp;&amp; cf.EqualsIgnoreCase(engine_type-&gt;GetName(), "WIA")) {
        return false;</span>
<span style = "background-color:#fdd">    }</span>
<span style = "background-color:#dfd">    else if(cf.EqualsIgnoreCase(car_type-&gt;GetName(), "Truck") &amp;&amp; cf.EqualsIgnoreCase(brake_type-&gt;GetName(), "MANDO")) {
        return false;</span>
<span style = "background-color:#fdd">    }</span>
<span style = "background-color:#dfd">    else if(cf.EqualsIgnoreCase(brake_type-&gt;GetName(), "BOSCH") &amp;&amp; false==cf.EqualsIgnoreCase(steering_type-&gt;GetName(), "BOSCH")) {
        return false;</span>
    }

<span style = "background-color:#dfd">    return true;
}</span>

<span style = "background-color:#dfd">void CarAssembleApp::RunProducedCar() {
    if(IsValidCheck() == false) {
        printf("ìëì°¨ê° ëìëì§ ììµëë¤\n");
        return;</span>
    }

<span style = "background-color:#dfd">    if(engine_type-&gt;GetName() == "BROKEN") {
        printf("ìì§ì´ ê³ ì¥ëììµëë¤.\n");
        printf("ìëì°¨ê° ìì§ì´ì§ ììµëë¤.\n");
        return;</span>
    }

<span style = "background-color:#dfd">    car_type-&gt;Print();
    engine_type-&gt;Print();
    brake_type-&gt;Print();
    steering_type-&gt;Print();</span>

<span style = "background-color:#dfd">    printf("ìëì°¨ê° ëìë©ëë¤.\n");
}</span>

<span style = "background-color:#dfd">void CarAssembleApp::TestProducedCar() {
    CommonFunction &amp;cf = CommonFunction::GetInstance();
    if(cf.EqualsIgnoreCase(car_type-&gt;GetName(), "Sedan") &amp;&amp; cf.EqualsIgnoreCase(brake_type-&gt;GetName(), "CONTINENTAL")) {
        printf("ìëì°¨ ë¶í ì¡°í© íì¤í¸ ê²°ê³¼ : FAIL\n");
        printf("Sedanìë Continentalì ëì¥ì¹ ì¬ì© ë¶ê°\n");
    }
    else if(cf.EqualsIgnoreCase(car_type-&gt;GetName(), "SUV") &amp;&amp; cf.EqualsIgnoreCase(engine_type-&gt;GetName(), "TOYOTA")) {
        printf("ìëì°¨ ë¶í ì¡°í© íì¤í¸ ê²°ê³¼ : FAIL\n");
        printf("SUVìë TOYOTAìì§ ì¬ì© ë¶ê°\n");
    }
    else if(cf.EqualsIgnoreCase(car_type-&gt;GetName(), "Truck") &amp;&amp; cf.EqualsIgnoreCase(engine_type-&gt;GetName(), "WIA")) {
        printf("ìëì°¨ ë¶í ì¡°í© íì¤í¸ ê²°ê³¼ : FAIL\n");
        printf("Truckìë WIAìì§ ì¬ì© ë¶ê°\n");
    }
    else if(cf.EqualsIgnoreCase(car_type-&gt;GetName(), "Truck") &amp;&amp; cf.EqualsIgnoreCase(brake_type-&gt;GetName(), "MANDO")) {
        printf("ìëì°¨ ë¶í ì¡°í© íì¤í¸ ê²°ê³¼ : FAIL\n");
        printf("Truckìë Mandoì ëì¥ì¹ ì¬ì© ë¶ê°\n");
    }
    else if(cf.EqualsIgnoreCase(brake_type-&gt;GetName(), "BOSCH") &amp;&amp; false == cf.EqualsIgnoreCase(steering_type-&gt;GetName(), "BOSCH")) {
        printf("ìëì°¨ ë¶í ì¡°í© íì¤í¸ ê²°ê³¼ : FAIL\n");
        printf("Boschì ëì¥ì¹ìë Boschì¡°í¥ì¥ì¹ ì´ì¸ ì¬ì© ë¶ê°\n");
    }</span>
    else {
<span style = "background-color:#dfd">        printf("ìëì°¨ ë¶í ì¡°í© íì¤í¸ ê²°ê³¼ : PASS\n");</span>
    }
<span style = "background-color:#dfd">}</span></pre>
        <hr />
        <table width="100%">
            <thead>
                <tr>
                    <th align="center">
                        <small>Generated by</small>
                        <a href="https://github.com/OpenCppCoverage/OpenCppCoverage/releases">
                            <strong>OpenCppCoverage (Version: 0.9.9.0)</strong>
                        </a>
                    </th>
                </tr>
            </thead>
        </table>
    </body>
</html>